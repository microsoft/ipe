<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://microsoft.github.io/ipe/usage/properties/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Properties - Integrity Policy Enforcement</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Integrity Policy Enforcement</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Usage <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Properties</a>
</li>
                                    
<li>
    <a href="../deployment/" class="dropdown-item">Deploying Policies</a>
</li>
                                    
<li>
    <a href="../examples/" class="dropdown-item">Example Policies</a>
</li>
                                    
<li>
    <a href="../events/" class="dropdown-item">Audit Events</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Technical <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../technical/threat-model/" class="dropdown-item">Threat Model</a>
</li>
                                    
<li>
    <a href="../../technical/diagrams/" class="dropdown-item">Technical Diagrams</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Other <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../faq/" class="dropdown-item">FAQ</a>
</li>
                                    
<li>
    <a href="../../presentations/" class="dropdown-item">Presentations</a>
</li>
                                    
<li>
    <a href="../../attribution/" class="dropdown-item">Attribution</a>
</li>
                                    
<li>
    <a href="../../license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../deployment/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/microsoft/ipe/edit/master/docs/usage/properties.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#ipe-properties" class="nav-link">IPE Properties</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#op" class="nav-link">op</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#action" class="nav-link">action</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#boot_verified" class="nav-link">boot_verified</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#dmverity_roothash" class="nav-link">dmverity_roothash</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#dmverity_signature" class="nav-link">dmverity_signature</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fsverity_digest" class="nav-link">fsverity_digest</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fsverity_signature" class="nav-link">fsverity_signature</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="ipe-properties">IPE Properties</h1>
<p>IPE properties are <code>key=value</code> pairs expressed in IPE
policy. Two properties are built into the policy parser: 'op' and 'action'.
The other properties are used to restrict immutable security properties
about the files being evaluated. Currently those properties are:
<code>boot_verified</code>, <code>dmverity_signature</code>, <code>dmverity_roothash</code>,
<code>fsverity_signature</code>, <code>fsverity_digest</code>. A description of all
properties supported by IPE are listed below:</p>
<h2 id="op">op</h2>
<p>Indicates the operation for a rule to apply to. Must be in every rule,
as the first token. IPE supports the following operations:</p>
<ul>
<li><strong>EXECUTE</strong></li>
<li>
<p>Pertains to any file attempting to be executed, or loaded as an
    executable.</p>
</li>
<li>
<p><strong>FIRMWARE</strong>:</p>
</li>
<li>
<p>Pertains to firmware being loaded via the firmware_class interface.
    This covers both the preallocated buffer and the firmware file
    itself.</p>
</li>
<li>
<p><strong>KMODULE</strong>:</p>
</li>
<li>
<p>Pertains to loading kernel modules via <code>modprobe</code> or <code>insmod</code>.</p>
</li>
<li>
<p><strong>KEXEC_IMAGE</strong>:</p>
</li>
<li>
<p>Pertains to kernel images loading via <code>kexec</code>.</p>
</li>
<li>
<p><strong>KEXEC_INITRAMFS</strong></p>
</li>
<li>
<p>Pertains to initrd images loading via <code>kexec --initrd</code>.</p>
</li>
<li>
<p><strong>POLICY</strong>:</p>
</li>
<li>
<p>Controls loading policies via reading a kernel-space initiated read.
    An example of such is loading IMA policies by writing the path
    to the policy file to <code>$securityfs/ima/policy</code>.</p>
</li>
<li>
<p><strong>X509_CERT</strong>:</p>
</li>
<li>Controls loading IMA certificates through the Kconfigs,
    <code>CONFIG_IMA_X509_PATH</code> and <code>CONFIG_EVM_X509_PATH</code>.</li>
</ul>
<h2 id="action">action</h2>
<p>Determines what IPE should do when a rule matches. Must be in every
rule, as the final clause. Can be one of:</p>
<ul>
<li><strong>ALLOW</strong>:</li>
<li>
<p>If the rule matches, explicitly allow access to the resource to proceed
    without executing any more rules.</p>
</li>
<li>
<p><strong>DENY</strong>:</p>
</li>
<li>If the rule matches, explicitly prohibit access to the resource to
    proceed without executing any more rules.</li>
</ul>
<h2 id="boot_verified">boot_verified</h2>
<p>This property can be utilized for authorization of files from initramfs.
The format of this property is:</p>
<pre><code>boot_verified=(TRUE|FALSE)
</code></pre>
<p><strong>WARNING:</strong></p>
<p>This property will trust files from initramfs(rootfs). It should
only be used during the early booting stage. Before mounting the real
rootfs on top of the initramfs, initramfs script will recursively
remove all files and directories on the initramfs. This is typically
implemented by using switch_root(8). Therefore the initramfs will be empty and not accessible after the real
rootfs takes over. It is advised to switch to a different policy
that doesn't rely on the property after this point.
This ensures that the trust policies remain relevant and effective
throughout the system's operation.</p>
<h2 id="dmverity_roothash">dmverity_roothash</h2>
<p>This property can be utilized for authorization or revocation of
specific dm-verity volumes, identified via its root hash. It has a
dependency on the DM_VERITY module. This property is controlled by
the <code>IPE_PROP_DM_VERITY</code> config option, it will be automatically
selected when <code>IPE_SECURITY</code>, <code>DM_VERITY</code> and
<code>DM_VERITY_VERIFY_ROOTHASH_SIG</code> are all enabled.
The format of this property is:</p>
<pre><code>dmverity_roothash=DigestName:HexadecimalString
</code></pre>
<p>The supported DigestNames for dmverity_roothash are:</p>
<ul>
<li>blake2b-512</li>
<li>blake2s-256</li>
<li>sha1</li>
<li>sha256</li>
<li>sha384</li>
<li>sha512</li>
<li>sha3-224</li>
<li>sha3-256</li>
<li>sha3-384</li>
<li>sha3-512</li>
<li>md4</li>
<li>md5</li>
<li>sm3</li>
<li>rmd160</li>
</ul>
<h2 id="dmverity_signature">dmverity_signature</h2>
<p>This property can be utilized for authorization of all dm-verity
volumes that have a signed roothash that validated by a keyring
specified by dm-verity's configuration, either the system trusted
keyring, or the secondary keyring. It depends on
<code>DM_VERITY_VERIFY_ROOTHASH_SIG</code> config option and is controlled by
the <code>IPE_PROP_DM_VERITY</code> config option, it will be automatically
selected when <code>IPE_SECURITY</code>, <code>DM_VERITY</code> and
<code>DM_VERITY_VERIFY_ROOTHASH_SIG</code> are all enabled.
The format of this property is:</p>
<pre><code>dmverity_signature=(TRUE|FALSE)
</code></pre>
<h2 id="fsverity_digest">fsverity_digest</h2>
<p>This property can be utilized for authorization or revocation of
specific fsverity enabled file, identified via its fsverity digest.
It depends on <code>FS_VERITY</code> config option and is controlled by
<code>CONFIG_IPE_PROP_FS_VERITY</code>. The format of this property is:</p>
<pre><code>fsverity_digest=DigestName:HexadecimalString
</code></pre>
<p>The supported DigestNames for fsverity_roothash are:</p>
<ul>
<li>sha256</li>
<li>sha512</li>
</ul>
<h2 id="fsverity_signature">fsverity_signature</h2>
<p>This property is used to authorize all fs-verity enabled files that have
been verified by fs-verity's built-in signature mechanism. The signature
verification relies on a key stored within the ".fs-verity" keyring. It
depends on <code>CONFIG_FS_VERITY_BUILTIN_SIGNATURES</code> and it is controlled by
the Kconfig <code>CONFIG_IPE_PROP_FS_VERITY</code>. The format of this
property is:</p>
<pre><code>fsverity_signature=(TRUE|FALSE)
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright (c) Microsoft. All rights reserved.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
